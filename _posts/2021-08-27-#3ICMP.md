---
layout: post
title: "ICMP"
categories: 네트워크
author: bn-tw2020
---
* content
{:toc}


## ICMP

* IP 패킷에서 헤더와 데이터 부분이 나뉜다. 헤더에는 목적지 주소 및 부가 정보들과 데이터는 주 메시지가 들어간다.

  ICMP는 사용자 데이터가 아닌 네트워크 상에서 여러 증상을 알기 위한 컨트롤 메시지이다.

  패킷이 잘 가다가 목적지 포트가 열려있지 않으면 drop 된다.

  헤더에 TTL가 라우터 거쳐갈 때마다 하나씩 줄어드는데 0이되면 drop 된다.

  그냥 drop되면 무슨 일이 일어나는지 알 수가 없다. 네트워크 상에서 발생하는 특정 이벤트에 대해서 src에게 알려줘야 한다.

  알려주기 위한 메시지들이 필요하다 이런거는 사용자 데이터 메시지가 아닌 네트워크 자체에서 생성한 메시지이다.

* TCP/IP 패킷 전송에서 발생한 각종 오류 정보를 보고하기 위해 이용하는 네트워크 프로토콜이다.

* 통신 중에 오류가 발생한 경우는 오류가 발생한 장소에서 패킷을 보낸 곳에 대해 ICMP를 사용하여 오류 정보를 반송한다.

* 중간 경로의 기기는 이 보고를 보고 네트워크에 발생한 장애를 알수가 있다.





## ICMP를 이용한 네트워크 검사

* ICMP를 이용한 네트워크 검사 명령으로 ping과 traceroute가 있다.

> ping

* 네트워크의 소통 상태를 확인하기 위한 명령이다.

  확인하고 싶은 컴퓨터에 대해 IP 패킷을 발행하여 올바르게 도착하여 응답이 일어나는지 확인한다.

* 정상적으로 실행되면 패킷이 무사히 전달된다는 것이기에 네트워크 소통을 확인할 수 있다.

  도착 시간도 표시되므로 간단한 네트워크 성능 확인에도 이용가능하다.

> traceroute

* 네트워크 경로를 조사하기 위한 명령이다. 

* 목적하는 컴퓨터에 도착하는 동안에 어떤 라우터를 경유하여 도착하는 지와 같은 정보를 목록으로 표시해준다.

* ping이 정상적으로 완료되지 않은 경우는 이 명령을 사용하여 경로상에서 오류를 일으키고 있는 위치를 찾아낼 수 있다.

* 경로 상에 존재하는 각 라우터로부터의 리스폰스 시간을 잴 수도 있다.

  그래서 네트워크의 병목 부분을 조사할 수가 있다.