---
layout: post
title: "네트워크 계층(1)"
categories: 네트워크
author: bn-tw2020
---
* content
{:toc}


## 네트워크 계층

* 네트워크 계층을 정리하기 전

  애플리케이션 계층은 request, response 하게 되면 데이터가 도착했었다. 
  
  전송 계층은 데이터가 어떻게 보내는지에 대해 이야기를 했다. 
  
  TCP는 신뢰성 있고 순서, 흐름, 혼잡 제어를 하게되고 UDP는 포트를 보고 바로 보내준다.

  즉, 보내면 가는 구나!! 라는 의미로 정리하였다.

* 네트워크 계층이라는 뚜껑을 열게 되면, 라우터들이 얽힌 형태가 나타난다.

  그 전에는 가면 좋고 안가면 어쩔수 없고였다. 
  
  네트워크 계층은 TCP 세그먼트를 어떻게 어떤 경로를 해서 목적지까지 배송을 할까라는 것이다.





<img width="443" alt="스크린샷 2021-08-27 오전 12 00 23" src="https://user-images.githubusercontent.com/66770613/130986965-e878aa32-e57c-4441-a5ba-440c71603fbc.png">  


## 라우터

* 라우터가 하는 일은 **포워딩** 이라는 작업과 **라우팅** 이라는 작업이다.

* 라우터는 패킷이 들어오면 목적지로 향하는 방향으로 전달하는 것이다.

  패킷이 들어오면 헤더에 적힌 목적지를 보고 그 방향으로 정한다. 그 방향을 판단해야하는데, 라우터 안에 포워딩 테이블이 존재한다.

* 포워딩 테이블은 어떤 특정 목적지로 가기 위해선 어떤 인터페이스로 보내라고 적혀있는 테이블이다.

* **포워딩** 이란 들어온 패킷의 목적지 주소와 포워딩 테이블의 엔트리를 매칭시켜서 그 엔트리에 해당하는 링크로 보내주는 것이다.

* 포워딩 테이블은 누가 만드는가 ?

  **라우팅**은 포워딩 테이블을 만들어 주는 일이고, 라우팅 알고리즘에 의해 만들어진다.

   
## 포워딩 테이블

* 포워딩 테이블은 key-value 형태로 이루어져 있을까 ? 목적지에 해당하는 인터페이스로 연결되어 있을까 ?

  하나에 하나씩 맵핑되어 있다고하면 테이블이 너무 커진다.

<img width="518" alt="스크린샷 2021-08-27 오전 12 00 55" src="https://user-images.githubusercontent.com/66770613/130987044-842542d3-5974-4115-bfb6-da2e4de4ed33.png">  

* 그래서 우체국에서 사용하는 방식인 주소 범위로 관리되어 이용한다. 

  아래의 그림처럼 범위로 의해 어디로 가라고 결정한다.

<img width="507" alt="스크린샷 2021-08-27 오전 12 01 56" src="https://user-images.githubusercontent.com/66770613/130987197-94eaa188-84e5-42f3-8613-69f2715fafcc.png">  

<img width="546" alt="스크린샷 2021-08-27 오전 12 07 53" src="https://user-images.githubusercontent.com/66770613/130988222-889170a3-9f2f-4f55-96b9-8f520a8cef75.png">  

* 위의 범위를 보게 되면, `11001000 00010111 00011000 10101010` 이 있다면 1, 2 Link interface에 해당한다.

  이 경우에는 주어진 목적지 주소에 대한 포워딩 테이블 항목을 찾을 때 목적지 주소와 일치하는 가장 긴 주소 접두사를 사용하게 됩니다.

  이것을 **Longest prefix matching** 이라고 한다.
